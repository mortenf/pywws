<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pywws.calib &mdash; documentation pywws 13.09_r1069</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '13.09_r1069',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/pywws_logo.ico"/>
    <link rel="top" title="documentation pywws 13.09_r1069" href="../index.html" />
    <link rel="up" title="Programmes et des modules Python" href="index.html" />
    <link rel="next" title="pywws.conversions" href="pywws.conversions.html" />
    <link rel="prev" title="pywws.Localisation" href="pywws.Localisation.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="pywws.conversions.html" title="pywws.conversions"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="pywws.Localisation.html" title="pywws.Localisation"
             accesskey="P">précédent</a> |</li>
        <li><a href="../index.html">documentation pywws 13.09_r1069</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Programmes et des modules Python</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-pywws.calib">
<span id="pywws-calib"></span><h1>pywws.calib<a class="headerlink" href="#module-pywws.calib" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="calibrate-raw-weather-station-data">
<h2>Calibre les données brutes de la station météo<a class="headerlink" href="#calibrate-raw-weather-station-data" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce module permet d&#8217;ajuster les données brutes de la station météo dans le cadre de l&#8217;étape de &#8216;traitement&#8217; (voir <a class="reference internal" href="pywws.Process.html"><em>pywws.Process</em></a> ). Par exemple, si vous avez installé un entonnoir pour doubler votre zone de collecte du pluviomètre, vous pouvez écrire une routine de calibration pour doubler la valeur de pluie.</p>
<dl class="docutils">
<dt>La classe de calibration par défaut fait deux choses:</dt>
<dd><ol class="first last arabic simple">
<li><p class="first">Générer pression atmosphérique relative.</p>
</li>
<li><p class="first">Retirer les valeurs invalides de direction du vent.</p>
</li>
</ol>
</dd>
</dl>
<p>Toute calibration utilisateur que vous écrivez doit également faire ceci.</p>
<div class="section" id="writing-your-calibration-module">
<h3>Écrire votre module de calibration<a class="headerlink" href="#writing-your-calibration-module" title="Lien permanent vers ce titre">¶</a></h3>
<p>Tout d&#8217;abord, décider où vous voulez garder votre module. Comme vos gabarits texte et graphe, il est préférable de le garder séparé du code pywws, de sorte qu&#8217;il n&#8217;est pas affecté par les mises à jour de pywws. Je suggère la création d&#8217;un répertoire <code class="docutils literal"><span class="pre">modules</span></code> au même endroit que votre répertoire <code class="docutils literal"><span class="pre">templates</span></code>.</p>
<p>Créez un fichier texte dans votre répertoire <code class="docutils literal"><span class="pre">modules</span></code>, par exemple, <code class="docutils literal"><span class="pre">Calib.py</span></code> et copiez-y le texte suivant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Calib</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pressure_offset</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fixed&#39;</span><span class="p">,</span> <span class="s">&#39;pressure offset&#39;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">calib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="c"># sanitise data</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;wind_dir&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;wind_dir&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s">&#39;wind_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># calculate relative pressure</span>
        <span class="n">result</span><span class="p">[</span><span class="s">&#39;rel_pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s">&#39;abs_pressure&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure_offset</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>La classe <a class="reference internal" href="#pywws.calib.Calib" title="pywws.calib.Calib"><code class="xref py py-class docutils literal"><span class="pre">Calib</span></code></a> a deux méthodes. <code class="xref py py-meth docutils literal"><span class="pre">Calib.__init__()</span></code> est le constructeur et est un bon endroit pour mettre toutes les constantes nécessaires. :py: meth:<cite>Calib.calib</cite> génère un ensemble unique de données &#8216;calibrées&#8217; à partir d&#8217;un seul ensemble de données &#8216;brutes&#8217;. Il y a quelques règles à suivre lors de l&#8217;écriture de cette méthode:</p>
<blockquote>
<div><ul class="simple">
<li><p class="first">Assurez-vous d&#8217;inclure la ligne <code class="docutils literal"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">dict(raw)</span></code>, qui permet de copier toutes les données brutes à votre résultat, au début.</p>
</li>
<li><p class="first">Ne modifiez pas les données brutes.</p>
</li>
<li><p class="first">Assurez-vous que vous définissez <code class="docutils literal"><span class="pre">result['rel_pressure']</span></code>.</p>
</li>
<li><p class="first">N&#8217;oubliez pas de retourner (<code class="docutils literal"><span class="pre">return</span></code>) le résultat à la fin.</p>
</li>
</ul>
</div></blockquote>
<p>Lorsque vous avez fini d&#8217;écrire votre module de calibration vous pouvez demander à pywws de l&#8217;utiliser en mettant son emplacement dans votre fichier <code class="docutils literal"><span class="pre">weather.ini</span></code>. Il va dans les sections <code class="docutils literal"><span class="pre">[paths]</span></code>, comme le montre l&#8217;exemple ci-dessous:</p>
<div class="highlight-python"><div class="highlight"><pre>[paths]
work = /tmp/weather
templates = /home/jim/weather/templates/
graph_templates = /home/jim/weather/graph_templates/
user_calib = /home/jim/weather/modules/usercalib
</pre></div>
</div>
<p>Notez que la valeur de <code class="docutils literal"><span class="pre">user_calib</span></code> ne doit pas inclure le <code class="docutils literal"><span class="pre">.py</span></code> à la fin du nom de fichier.</p>
<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pywws.calib.Calib" title="pywws.calib.Calib"><code class="xref py py-obj docutils literal"><span class="pre">Calib</span></code></a>(params,&nbsp;status)</td>
<td><p class="first last">Classe qui implémente la calibration par défaut ou la calibration par l&#8217;utilisateur.</p>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pywws.calib.DefaultCalib" title="pywws.calib.DefaultCalib"><code class="xref py py-obj docutils literal"><span class="pre">DefaultCalib</span></code></a>(status)</td>
<td><p class="first last">Classe de calibration par défaut</p>
</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">datetime</span></code>(year,&nbsp;month,&nbsp;day[,&nbsp;hour[,&nbsp;minute[,&nbsp;...)</td>
<td>The year, month and day arguments are required.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">timedelta</span></code></td>
<td><p class="first last">Différence entre deux valeurs de datetime.</p>
</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="pywws.calib.DefaultCalib">
<em class="property">class </em><code class="descclassname">pywws.calib.</code><code class="descname">DefaultCalib</code><span class="sig-paren">(</span><em>status</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pywws/calib.html#DefaultCalib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pywws.calib.DefaultCalib" title="Permalien vers cette définition">¶</a></dt>
<dd><p>Classe de calibration par défaut</p>
<p>Cette classe définit la pression relative, en utilisant un décalage de pression lues à partir de la station météorologique, et &#8216;normalise&#8217; la valeur de la direction du vent. C&#8217;est la calibration strictement minimale nécessaire.</p>
<dl class="method">
<dt id="pywws.calib.DefaultCalib.calib">
<code class="descname">calib</code><span class="sig-paren">(</span><em>raw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pywws/calib.html#DefaultCalib.calib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pywws.calib.DefaultCalib.calib" title="Permalien vers cette définition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pywws.calib.Calib">
<em class="property">class </em><code class="descclassname">pywws.calib.</code><code class="descname">Calib</code><span class="sig-paren">(</span><em>params</em>, <em>status</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pywws/calib.html#Calib"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pywws.calib.Calib" title="Permalien vers cette définition">¶</a></dt>
<dd><p>Classe qui implémente la calibration par défaut ou la calibration par l&#8217;utilisateur.</p>
<p>D&#8217;autres modules pywws utilisent cette méthode pour créer un objet de calibration. Le constructeur crée soit un objet de calibration par défaut ou un objet de calibration utilisateur, en fonction de la valeur <code class="docutils literal"><span class="pre">user_calib</span></code> dans la section <code class="docutils literal"><span class="pre">[paths]</span></code> du paramètre <code class="docutils literal"><span class="pre">params</span></code>. Il adopte alors la méthode de calibration de l&#8217;objet :py: meth:<cite>calib</cite> comme sien.</p>
<dl class="attribute">
<dt id="pywws.calib.Calib.calibrator">
<code class="descname">calibrator</code><em class="property"> = None</em><a class="headerlink" href="#pywws.calib.Calib.calibrator" title="Permalien vers cette définition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/pywws_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table des Matières</a></h3>
  <ul>
<li><a class="reference internal" href="#">pywws.calib</a><ul>
<li><a class="reference internal" href="#calibrate-raw-weather-station-data">Calibre les données brutes de la station météo</a><ul>
<li><a class="reference internal" href="#writing-your-calibration-module">Écrire votre module de calibration</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="pywws.Localisation.html"
                        title="Chapitre précédent">pywws.Localisation</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="pywws.conversions.html"
                        title="Chapitre suivant">pywws.conversions</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="pywws.conversions.html" title="pywws.conversions"
             >suivant</a> |</li>
        <li class="right" >
          <a href="pywws.Localisation.html" title="pywws.Localisation"
             >précédent</a> |</li>
        <li><a href="../index.html">documentation pywws 13.09_r1069</a> &raquo;</li>
          <li><a href="index.html" >Programmes et des modules Python</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2008-13, Jim Easterbrook.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b2.
    </div>
  </body>
</html>